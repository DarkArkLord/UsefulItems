<!DOCTYPE html>
<html>

<head>
    <title>Тест точных вычислений</title>
</head>

<body>
    <textarea id="output" readonly rows="30" cols="120"></textarea>
</body>
<!-- preciseCalculations -->
<script src="./PreciseCalculations.js"></script>
<!-- test -->
<script>
    const out = document.getElementById('output');
    out.value = '';
    function pushOut(text) {
        out.value += text + '\n';
    }
    function PCtoText(val) {
        return `${val.toString()} => ${val.valueOf()} => ${val.round(2)}`;
    }
    function pushPC(val) {
        pushOut(PCtoText(val));
    }

    // --- Main ---
    // let t = new PreciseCalculations(2, 4);
    // pushPC(t);
    // let t2 = t.simplifyCopy();
    // pushPC(t2);
    // pushPC(t);
    // t = PreciseCalculations.fromNumber(5);
    // pushPC(t);
    // t = PreciseCalculations.fromNumber(1.2345);
    // pushPC(t);
    // t = PreciseCalculations.fromNumber(1.2345).simplify();
    // pushPC(t);
    // t = PreciseCalculations.fromNumber(Math.PI);
    // pushPC(t);

    // --- Math ---
    // let a = PreciseCalculations.fromNumber(4);
    // let b = PreciseCalculations.fromNumber(2);
    // pushPC(a.add(b));
    // pushPC(a.negative());
    // pushPC(a.sub(b));
    // pushPC(a.mul(b));
    // pushPC(a.reverse());
    // pushPC(a.div(b));
    // pushPC(a.div(b).simplify());

    // let t = PreciseCalculations.fromNumber(Math.PI);
    // pushOut(Math.PI);
    // pushPC(t);
    // pushOut(Math.PI + Math.PI + Math.PI + Math.PI);
    // t = t.add(t).add(t).add(t);
    // pushPC(t);
    // pushPC(t.simplifyCopy());

    // --- a ---
    let sum = 360;
    pushOut(`sum: ${sum}`);
    let partsCount = 29;
    pushOut(`partsCount: ${partsCount}`);

    pushOut('--- float ---');
    let part = sum / partsCount;
    pushOut(`part: ${part}`);
    let newSum = 0;
    for (let i = 0; i < partsCount; i++) {
        newSum += part;
    }
    pushOut(`newSum: ${newSum}`);

    pushOut('--- float round 2 ---');
    part = parseFloat((sum / partsCount).toFixed(2));
    pushOut(`part: ${part}`);
    newSum = 0;
    for (let i = 0; i < partsCount; i++) {
        newSum = parseFloat((newSum + part).toFixed(2));
    }
    pushOut(`newSum: ${newSum}`);

    pushOut('--- pc ---');
    part = PreciseCalculations.fromNumber(sum).divNumber(partsCount);
    pushOut(`part: ${PCtoText(part)}`);
    newSum = PreciseCalculations.fromNumber(0);
    for (let i = 0; i < partsCount; i++) {
        newSum = newSum.add(part);
    }
    pushOut(`newSum: ${PCtoText(newSum)}`);


</script>

</html>